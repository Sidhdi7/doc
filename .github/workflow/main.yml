name: Node.js CI + Contributor Greeting

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]

jobs:
  build:
    name: ğŸ”§ Build and Test Node.js App
    runs-on: ubuntu-latest

    steps:
    - name: âœ… Checkout code
      uses: actions/checkout@v3

    - name: ğŸ§° Set up Node.js
      uses: actions/setup-node@v3
      with:
        node-version: '18'

    - name: ğŸ“¦ Install dependencies
      run: npm install

    - name: ğŸ§ª Run tests (if any)
      run: |
        echo "No tests defined yet"
        # npm test  # Uncomment if you add tests later

    - name: ğŸ§ Show runner environment
      run: uname -a

  greet-contributor:
    name: ğŸ‘‹ Greet First-Time Contributor
    runs-on: ubuntu-latest
    if: github.event.pull_request.user.login != github.repository_owner
    steps:
    - name: ğŸ’¬ Post welcome comment
      uses: actions/github-script@v6
      with:
        script: |
          github.rest.issues.createComment({
            issue_number: context.issue.number,
            owner: context.repo.owner,
            repo: context.repo.repo,
            body: "ğŸ‰ Welcome to the project, @${{ github.actor }}! Thanks for contributing! ğŸš€"
          })

  log-success:
    name: âœ… Log Completion
    runs-on: ubuntu-latest
    needs: build
    steps:
    - name: ğŸ¯ Final log
      run: echo "ğŸ‰ All CI jobs completed successfully on Ubuntu!"
